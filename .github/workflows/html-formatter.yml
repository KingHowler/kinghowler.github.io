name: Format HTML Files

on:
  push:
    branches:
      - gh-pages

jobs:
  format:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout gh-pages branch
      uses: actions/checkout@v3
      with:
        ref: gh-pages

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '16'

    - name: Install Prettier
      run: npm install -g prettier

    - name: Format HTML files
      run: |
        prettier --write '**/*.html'
        
    - name: Commit formatted files
      run: |
        git config user.name "github-actions"
        git config user.email "github-actions@github.com"
        git add .
        git commit -m "Format HTML files" || echo "No changes to commit"
        git push origin gh-pages
        
    - name: Checkout master branch
      uses: actions/checkout@v3
      with:
        ref: master

    - name: Copy formatted files from gh-pages
      run: |
        git checkout gh-pages
        mkdir -p ./
        cp -r * ../

    - name: Commit changes to master branch
      run: |
        git config user.name "github-actions"
        git config user.email "github-actions@github.com"
        git add .
        git commit -m "Update formatted HTML files from gh-pages" || echo "No changes to commit"
        git push origin master
